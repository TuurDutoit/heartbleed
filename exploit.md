Heartbleed exploit
===
In the `exploit` directory, you can find a sample Heartbleed exploit script written in Javascript. The `exploit.js` file is main entrypoint, documented below. The `src` subdirectory contains some utilities used by this script, most notably a simple parser for (some) TLS packets in `parser.js`. You can actually use this parser from the command line using the `parser.js` script in the `exploit` directory.

## exploit.js
This is main script that exploits the Heartbleed bug. 

### Usage
```
node exploit/exploit.js <host>
```

This will connect to `<host>` on port 443 by default and try to exploit the OpenSSL library. Some extra options can be provided:

- `-p` or `--port`: specify another port
- `-o` or `--out`: specify a file where you want the Heartbeat's response data to be written to

### Working
The script is rather simple:
- First, it connects to the server (of course)
- A normal Client Hello record is sent
- We ignore the Server Hello, Certificate, etc. records
- When the Server Hello Done request comes in, we send the evi Heartbeat request
- The server (hopefully?) sends back a Heartbeat response with some private data
- The data is written to the specified file (if the `-o` option is used)

## parser.js
This repository contains a simple parser that can decode (some) TLS records. You can use this parser to decode a packet you saved to a file.

### Usage
```
node exploit/parse.js <file>
```

Simply call the script with Node.js and pass it the path to a file containing a TLS packet. It will print a JSON respresentation of the record to stdout.